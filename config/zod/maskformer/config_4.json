{
    "Summary": "ZOD MaskFormer-Tiny LiDAR",
    "tags": ["ZOD", "MaskFormer", "Tiny", "LiDAR"],
    "CLI": {"backbone": "maskformer", "mode": "lidar", "path": "zod_dataset/"},
    "General": {
        "device": "cuda:0",
        "epochs": 50,
        "batch_size": 16,
        "path_predicted_images": "output",
        "seed": 0,
        "resume_training": false,
        "reset_lr": false,
        "early_stop_patience": 200,
        "save_epoch": 20,
        "model_path": ""
    },
    "Log": {"logdir": "logs/maskformer/config_4"},
    "MaskFormer": {
        "model_timm": "swinv2_tiny_window8_256",
        "pixel_decoder_channels": 256,
        "transformer_d_model": 256,
        "num_queries": 100,
        "clft_lr": 1e-4,
        "lr_momentum": 0.99,
        "pretrained": true
    },
    "Dataset": {
        "name": "zod",
        "dataset_root": "zod_dataset/",
        "annotation_path": "annotation_lidar_only",
        "train_split": "zod_dataset/train.txt",
        "val_split": "zod_dataset/validation.txt",
        "splits": {"split_train": 0.6, "split_val": 0.2, "split_test": 0.2},
        "transforms": {
            "resize": 256,
            "random_rotate_range": 20,
            "p_flip": 0.5,
            "p_crop": 0.3,
            "p_rot": 0.4,
            "image_mean": [0.325291, 0.325736, 0.331795],
            "image_std": [0.168061, 0.179542, 0.204609],
            "lidar_mean": [0.049261, 0.049575, 0.092697],
            "lidar_std": [0.07696, 0.073541, 0.098311],
            "lidar_mean_waymo": [-0.17263354, 0.85321806, 24.5527253],
            "lidar_std_waymo": [7.34546552, 1.17227659, 15.83745082]
        },
        "dataset_classes": [
            {"name": "background", "index": 0},
            {"name": "ignore", "index": 1},
            {"name": "vehicle", "index": 2},
            {"name": "sign", "index": 3},
            {"name": "cyclist", "index": 4},
            {"name": "pedestrian", "index": 5}
        ],
        "train_classes": [
            {"name": "background", "index": 0, "weight": 0.1, "dataset_mapping": [0, 1], "color": [0, 0, 0]},
            {"name": "vehicle", "index": 1, "weight": 10.0, "dataset_mapping": [2], "color": [128, 0, 128]},
            {"name": "sign", "index": 2, "weight": 15.0, "dataset_mapping": [3], "color": [255, 0, 0]},
            {"name": "human", "index": 3, "weight": 20.0, "dataset_mapping": [4, 5], "color": [0, 255, 255]}
        ]
    },
    "Loss": {
        "name": "maskformer_loss",
        "weight_dict": {
            "loss_ce": 2.0,
            "loss_mask": 5.0,
            "loss_dice": 5.0,
            "loss_ce_0": 2.0,
            "loss_mask_0": 5.0,
            "loss_dice_0": 5.0,
            "loss_ce_1": 2.0,
            "loss_mask_1": 5.0,
            "loss_dice_1": 5.0,
            "loss_ce_2": 2.0,
            "loss_mask_2": 5.0,
            "loss_dice_2": 5.0,
            "loss_ce_3": 2.0,
            "loss_mask_3": 5.0,
            "loss_dice_3": 5.0,
            "loss_ce_4": 2.0,
            "loss_mask_4": 5.0,
            "loss_dice_4": 5.0,
            "loss_ce_5": 2.0,
            "loss_mask_5": 5.0,
            "loss_dice_5": 5.0,
            "loss_ce_6": 2.0,
            "loss_mask_6": 5.0,
            "loss_dice_6": 5.0,
            "loss_ce_7": 2.0,
            "loss_mask_7": 5.0,
            "loss_dice_7": 5.0,
            "loss_ce_8": 2.0,
            "loss_mask_8": 5.0,
            "loss_dice_8": 5.0,
            "loss_ce_9": 2.0,
            "loss_mask_9": 5.0,
            "loss_dice_9": 5.0
        },
        "eos_coef": 0.1
    },
    "Optimizer": {
        "name": "adamw",
        "lr": 1e-4,
        "weight_decay": 0.05,
        "betas": [0.9, 0.999]
    },
    "Scheduler": {
        "name": "polynomial",
        "power": 0.9,
        "warmup_iters": 10,
        "warmup_ratio": 1e-6
    }
}