python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

ssh totahv@base.hpc.taltech.ee
cd /gpfs/mariana/smbhome/totahv/clft-zod-training
cd /gpfs/mariana/home/totahv/

watch -n1 squeue -u totahv

sbatch -J t-base train_deeplabv3plus.slurm config/waymo/deeplabv3/rgb_baseline.json
sbatch -J t-s train_deeplabv3plus.slurm config/waymo/deeplabv3/rgb_sign_specialization.json
sbatch -J t-h train_deeplabv3plus.slurm config/waymo/deeplabv3/rgb_human_specialization.json
sbatch -J t-v train_deeplabv3plus.slurm config/waymo/deeplabv3/rgb_vehicle_specialization.json
sbatch -J t-hs train_deeplabv3plus.slurm config/waymo/deeplabv3/rgb_human_sign.json
sbatch -J t-hv train_deeplabv3plus.slurm config/waymo/deeplabv3/rgb_human_vehicle.json
sbatch -J t-vs train_deeplabv3plus.slurm config/waymo/deeplabv3/rgb_vehicle_sign.json

sbatch -J t-1 train_deeplabv3plus.slurm config/zod/deeplabv3/lidar_baseline.json
sbatch -J t-2 train_deeplabv3plus.slurm config/zod/deeplabv3/deeplabv3plus_fusion_average.json
sbatch -J t-3 train_deeplabv3plus.slurm config/zod/deeplabv3/deeplabv3plus_fusion_learned.json
sbatch -J t-4 train_deeplabv3plus.slurm config/zod/deeplabv3/deeplabv3plus_fusion_weighted.json

python visualize_deeplabv3plus.py --config config/waymo/deeplabv3/rgb_baseline.json --upload
python visualize_deeplabv3plus.py --config config/waymo/deeplabv3/rgb_sign_specialization.json --upload
python visualize_deeplabv3plus.py --config config/waymo/deeplabv3/rgb_human_specialization.json --upload
python visualize_deeplabv3plus.py --config config/waymo/deeplabv3/rgb_vehicle_specialization.json --upload
python visualize_deeplabv3plus.py --config config/waymo/deeplabv3/rgb_human_sign.json --upload
python visualize_deeplabv3plus.py --config config/waymo/deeplabv3/rgb_human_vehicle.json --upload
python visualize_deeplabv3plus.py --config config/waymo/deeplabv3/rgb_vehicle_sign.json --upload


sbatch -J t-hs train.slurm config/waymo_hpc/clft/human_sign.json
sbatch -J t-hv train.slurm config/waymo_hpc/clft/human_vehicle.json
sbatch -J t-vs train.slurm config/waymo_hpc/clft/vehicle_sign.json
sbatch -J t-v train.slurm config/waymo_hpc/clft/vehicle_specialization.json
sbatch -J t-h train.slurm config/waymo_hpc/clft/human_specialization.json
sbatch -J t-s train.slurm config/waymo_hpc/clft/sign_specialization.json
sbatch -J t-2 train.slurm config/waymo_hpc/clft/config_2.json

sbatch -J t-hs test.slurm config/waymo_hpc/clft/human_sign.json
sbatch -J t-hv test.slurm config/waymo_hpc/clft/human_vehicle.json
sbatch -J t-vs test.slurm config/waymo_hpc/clft/vehicle_sign.json
sbatch -J t-v test.slurm config/waymo_hpc/clft/vehicle_specialization.json
sbatch -J t-h test.slurm config/waymo_hpc/clft/human_specialization.json
sbatch -J t-s test.slurm config/waymo_hpc/clft/sign_specialization.json
sbatch -J t-2 test.slurm config/waymo_hpc/clft/config_2.json

# ZOD RGB
sbatch -J train-1z train.slurm ./config/zod_hpc/config_1.json
sbatch -J train-2z train.slurm ./config/zod_hpc/config_2.json
sbatch -J train-3z train.slurm ./config/zod_hpc/config_3.json
# ZOD Lidar
sbatch -J train-4z train.slurm ./config/zod_hpc/config_4.json
sbatch -J train-5z train.slurm ./config/zod_hpc/config_5.json
sbatch -J train-6z train.slurm ./config/zod_hpc/config_6.json
# ZOD Fusion
sbatch -J train-7z train.slurm ./config/zod_hpc/config_7.json
sbatch -J train-8z train.slurm ./config/zod_hpc/config_8.json
sbatch -J train-9z train.slurm ./config/zod_hpc/config_9.json
# Specialization Hybrid
sbatch -J train-hs train.slurm ./config/zod_hpc/human_sign.json
sbatch -J train-hs train.slurm ./config/zod_hpc/human_specialization.json
sbatch -J train-hs train.slurm ./config/zod_hpc/human_vehicle.json
sbatch -J train-hs train.slurm ./config/zod_hpc/sign_specialization.json
sbatch -J train-hs train.slurm ./config/zod_hpc/vehicle_sign.json
sbatch -J train-hs train.slurm ./config/zod_hpc/vehicle_specialization.json

# Waymo Base
sbatch -J train-1w train.slurm ./config/waymo_hpc/config_1.json
sbatch -J train-4w train.slurm ./config/waymo_hpc/config_4.json
sbatch -J train-7w train.slurm ./config/waymo_hpc/config_7.json

# Waymo Hybrid
sbatch -J train-2w train.slurm ./config/waymo_hpc/config_2.json
sbatch -J train-5w train.slurm ./config/waymo_hpc/config_5.json
sbatch -J train-8w train.slurm ./config/waymo_hpc/config_8.json

# Waymo Large
sbatch -J train-3w train.slurm ./config/waymo_hpc/config_3.json
sbatch -J train-6w train.slurm ./config/waymo_hpc/config_6.json
sbatch -J train-9w train.slurm ./config/waymo_hpc/config_9.json

# Copy json files from server to local
rsync -avz --include='*/' --include='*.json' --exclude='*' totahv@base.hpc.taltech.ee:/gpfs/mariana/smbhome/totahv/clft-zod-training/logs /media/tom/ml/hpc_logs

# Copy data to server
rsync -avz /media/tom/ml/projects/clft-zod-training/zod_dataset totahv@base.hpc.taltech.ee:/gpfs/mariana/smbhome/totahv/clft-zod-training/
rsync -avz /media/tom/ml/projects/clft-zod-training/waymo_dataset totahv@base.hpc.taltech.ee:/gpfs/mariana/smbhome/totahv/clft-zod-training/

# Download specific epoch file from server to local
rsync -avz totahv@base.hpc.taltech.ee:/gpfs/mariana/smbhome/totahv/clft-zod-training/logs/zod/swin/config_9/checkpoints/epoch_49_becfeb0e-7d74-4e30-8bec-a4b1f0db68fd.pth /media/tom/ml/clftv2_fusion_large.pth
rsync -avz totahv@base.hpc.taltech.ee:/gpfs/mariana/smbhome/totahv/clft-zod-training/logs/zod/clft/config_8/checkpoints/epoch_49_71f5b556-d4e0-42bd-bc39-3f7fb65a40b0.pth /media/tom/ml/clftv1_fusion_hybrid.pth

rsync -avz totahv@base.hpc.taltech.ee:/gpfs/mariana/smbhome/totahv/clft-zod-training/logs/waymo/swin/config_8/checkpoints/epoch_49_2ea14d3d-490b-4d65-91a9-631cd6b9c827.pth /media/tom/ml/clftv2_base_waymo.pth
